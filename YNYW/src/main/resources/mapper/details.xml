<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" > 
<mapper namespace="com.example.demo.dao.DetailsDao"> 
 	<sql id="Base_Column_List"> 
 		book_id,author_name,education_name,book_name,quantity,delete_flg
 	</sql>  
 
	<select id="findBook" resultType="com.example.demo.Entity.Book" parameterType="com.example.demo.Entity.Book"> 
 		select
 		<include refid="Base_Column_List" />
 		from t_book
 		<where>
 		<if test="bookName!=null">
 		and book_name like CONCAT('%',#{bookName},'%')
 		</if>
 		<if test="authorName!=null">
 		and author_name like CONCAT('%',#{authorName},'%')
 		</if>
 		<if test="educationName!=null">
 		and education_name like CONCAT('%',#{educationName},'%')
 		</if>
 		<if test="bookId!=''">
 		and book_id=#{bookId}
 		</if>
 		</where>
 	</select> 
 	<select id="find" resultType="com.example.demo.Entity.Book" parameterType="String">
 	    select
 		<include refid="Base_Column_List" />
 		from t_book where book_id=#{bookId}
 	</select>
 	<insert id="insetrental" parameterType="com.example.demo.Entity.rental">
 	insert into t_rental(user_id,book_id,rental_datetime) value (#{userId},#{bookId},#{rentalDatetime})
 	</insert>
 	<update id="updatebook" parameterType="com.example.demo.Entity.Book">
    update t_book set quantity=#{quantity} where book_id=#{bookId}
 	</update>
 	<select id="revertselect" parameterType="com.example.demo.Entity.rental" resultType="com.example.demo.Entity.rental">
 	select * from t_rental where user_id=#{userId} and book_id=#{bookId}
 	</select>
 	<update id="revertupdate">
 	update t_book set quantity=#{quantity} where book_id=#{bookId}
 	</update>
</mapper> 
